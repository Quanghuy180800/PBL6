{"ast":null,"code":"import { useState, useEffect } from 'react';\nimport axios from 'axios';\nimport { store } from 'react-notifications-component';\n\nfunction UserAPI(token) {\n  const [isLogged, setIsLogged] = useState(false);\n  const [isAdmin, setIsAdmin] = useState(false);\n  const [cart, setCart] = useState([]);\n  const [wishlist, setWishlist] = useState([]);\n  const [history, setHistory] = useState([]);\n  useEffect(() => {\n    if (token) {\n      const getUser = async () => {\n        try {\n          const res = await axios.get('/user/infor', {\n            headers: {\n              Authorization: token\n            }\n          });\n          setIsLogged(true);\n          res.data.role === 1 ? setIsAdmin(true) : setIsAdmin(false);\n          setCart(res.data.cart);\n          setWishlist(res.data.wishlist);\n        } catch (err) {\n          alert(err.response.data.msg);\n        }\n      };\n\n      getUser();\n    }\n  }, [token]);\n\n  const addCart = async product => {\n    if (!isLogged) {\n      store.addNotification({\n        title: \"Please Login!!\",\n        message: \"Please login to add your cart!\",\n        type: \"danger\",\n        insert: \"top\",\n        container: \"top-center\",\n        animationIn: [\"animate__animated\", \"animate__fadeIn\"],\n        animationOut: [\"animate__animated\", \"animate__fadeOut\"],\n        dismiss: {\n          duration: 2500,\n          onScreen: true\n        }\n      });\n    } else {\n      console.log(product.sold);\n\n      if (product.sold === 0) {\n        const check = cart.every(item => {\n          console.log(item.sold);\n          if (item.sold === 0) return item._id !== product._id;\n          return false;\n        });\n\n        if (check) {\n          setCart([...cart, { ...product,\n            quantity: 1\n          }]);\n          await axios.patch('/user/addcart', {\n            cart: [...cart, { ...product,\n              quantity: 1\n            }]\n          }, {\n            headers: {\n              Authorization: token\n            }\n          });\n          store.addNotification({\n            title: \"SuccessFul added to cart!\",\n            message: \"Please check your cart!\",\n            type: \"success\",\n            insert: \"top\",\n            container: \"top-right\",\n            animationIn: [\"animate__animated\", \"animate__fadeIn\"],\n            animationOut: [\"animate__animated\", \"animate__fadeOut\"],\n            dismiss: {\n              duration: 2500,\n              onScreen: true\n            }\n          });\n        } else {\n          store.addNotification({\n            title: \"This product just in your cart!\",\n            message: \"Please check your cart!\",\n            type: \"warning\",\n            insert: \"top\",\n            container: \"top-right\",\n            animationIn: [\"animate__animated\", \"animate__fadeIn\"],\n            animationOut: [\"animate__animated\", \"animate__fadeOut\"],\n            dismiss: {\n              duration: 2500,\n              onScreen: true\n            }\n          });\n        }\n      } else {\n        store.addNotification({\n          title: \"Out of stock!!\",\n          message: \"So sorry, this product was sold out!!\",\n          type: \"danger\",\n          insert: \"top\",\n          container: \"top-center\",\n          animationIn: [\"animate__animated\", \"animate__fadeIn\"],\n          animationOut: [\"animate__animated\", \"animate__fadeOut\"],\n          dismiss: {\n            duration: 2500,\n            onScreen: true\n          }\n        });\n      }\n    }\n  };\n\n  const addWishList = async product => {\n    if (!isLogged) {\n      store.addNotification({\n        title: \"Please Login!!\",\n        message: \"Login to like this!\",\n        type: \"danger\",\n        insert: \"top\",\n        container: \"top-center\",\n        animationIn: [\"animate__animated\", \"animate__fadeIn\"],\n        animationOut: [\"animate__animated\", \"animate__fadeOut\"],\n        dismiss: {\n          duration: 2500,\n          onScreen: true\n        }\n      });\n    } else {\n      const check = wishlist.every(item => {\n        return item._id !== product._id;\n      });\n\n      if (check) {\n        setWishlist([...wishlist, { ...product,\n          quantity: 1\n        }]);\n        await axios.patch('/user/addwishlist', {\n          wishlist: [...wishlist, { ...product,\n            quantity: 1\n          }]\n        }, {\n          headers: {\n            Authorization: token\n          }\n        });\n        store.addNotification({\n          title: \"You like it!\",\n          message: \"This product is in your wishlist!\",\n          type: \"success\",\n          insert: \"top\",\n          container: \"top-right\",\n          animationIn: [\"animate__animated\", \"animate__fadeIn\"],\n          animationOut: [\"animate__animated\", \"animate__fadeOut\"],\n          dismiss: {\n            duration: 2500,\n            onScreen: true\n          }\n        });\n      } else {\n        store.addNotification({\n          title: \"This product just in your wishlist!\",\n          message: \"Please check its!\",\n          type: \"warning\",\n          insert: \"top\",\n          container: \"top-right\",\n          animationIn: [\"animate__animated\", \"animate__fadeIn\"],\n          animationOut: [\"animate__animated\", \"animate__fadeOut\"],\n          dismiss: {\n            duration: 2500,\n            onScreen: true\n          }\n        });\n      }\n    }\n  };\n\n  return {\n    isLogged: [isLogged, setIsLogged],\n    isAdmin: [isAdmin, setIsAdmin],\n    cart: [cart, setCart],\n    wishlist: [wishlist, setWishlist],\n    addCart: addCart,\n    addWishList: addWishList,\n    history: [history, setHistory]\n  };\n}\n\nexport default UserAPI;","map":{"version":3,"sources":["/home/phuocnghia712/Desktop/CSHTTT/client/src/api/UserAPI.js"],"names":["useState","useEffect","axios","store","UserAPI","token","isLogged","setIsLogged","isAdmin","setIsAdmin","cart","setCart","wishlist","setWishlist","history","setHistory","getUser","res","get","headers","Authorization","data","role","err","alert","response","msg","addCart","product","addNotification","title","message","type","insert","container","animationIn","animationOut","dismiss","duration","onScreen","console","log","sold","check","every","item","_id","quantity","patch","addWishList"],"mappings":"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","sourcesContent":["import {useState, useEffect} from 'react'\nimport axios from 'axios'\nimport { store } from 'react-notifications-component';\n\nfunction UserAPI(token) {\n    const [isLogged, setIsLogged] = useState(false)\n    const [isAdmin, setIsAdmin] = useState(false)\n    const [cart, setCart] = useState([])\n    const [wishlist,setWishlist] = useState([])\n    const [history, setHistory] = useState([])\n\n    useEffect(() =>{\n        if(token){\n            const getUser = async () =>{\n                try {\n                    const res = await axios.get('/user/infor', {\n                        headers: {Authorization: token}\n                    })\n\n                    setIsLogged(true)\n                    res.data.role === 1 ? setIsAdmin(true) : setIsAdmin(false)\n\n                    setCart(res.data.cart)\n                    setWishlist(res.data.wishlist)\n\n                } catch (err) {\n                    alert(err.response.data.msg)\n                }\n            }\n\n            getUser()\n            \n        }\n    },[token])\n\n    \n\n    const addCart = async (product) => {\n        if(!isLogged) \n        {\n            store.addNotification({\n                title: \"Please Login!!\",\n                message: \"Please login to add your cart!\",\n                type: \"danger\",\n                insert: \"top\",\n                container: \"top-center\",\n                animationIn: [\"animate__animated\", \"animate__fadeIn\"],\n                animationOut: [\"animate__animated\", \"animate__fadeOut\"],\n                dismiss: {\n                  duration: 2500,\n                  onScreen: true\n                },\n                \n              });\n        }\n        else{\n        console.log(product.sold)  \n        if(product.sold === 0 ){ \n\n        const check = cart.every(item =>{\n          console.log(item.sold)\n          if(item.sold === 0) return item._id !== product._id\n          return false\n        })\n\n        if(check){\n\n            setCart([...cart, {...product, quantity: 1}])\n\n          await axios.patch('/user/addcart', {cart: [...cart, {...product, quantity: 1}]}, {\n                headers: {Authorization: token}\n            })\n\n            store.addNotification({\n                title: \"SuccessFul added to cart!\",\n                message: \"Please check your cart!\",\n                type: \"success\",\n                insert: \"top\",\n                container: \"top-right\",\n                animationIn: [\"animate__animated\", \"animate__fadeIn\"],\n                animationOut: [\"animate__animated\", \"animate__fadeOut\"],\n                dismiss: {\n                  duration: 2500,\n                  onScreen: true\n                }\n              });\n           \n        }else{\n            store.addNotification({\n                title: \"This product just in your cart!\",\n                message: \"Please check your cart!\",\n                type: \"warning\",\n                insert: \"top\",\n                container: \"top-right\",\n                animationIn: [\"animate__animated\", \"animate__fadeIn\"],\n                animationOut: [\"animate__animated\", \"animate__fadeOut\"],\n                dismiss: {\n                  duration: 2500,\n                  onScreen: true\n                },\n                \n              });\n        }\n    }\n    else{\n      store.addNotification({\n        title: \"Out of stock!!\",\n        message: \"So sorry, this product was sold out!!\",\n        type: \"danger\",\n        insert: \"top\",\n        container: \"top-center\",\n        animationIn: [\"animate__animated\", \"animate__fadeIn\"],\n        animationOut: [\"animate__animated\", \"animate__fadeOut\"],\n        dismiss: {\n          duration: 2500,\n          onScreen: true\n        },\n        \n      });\n    }\n    }\n    }\n\n    const addWishList = async (product) =>{\n        if(!isLogged) \n         {\n        store.addNotification({\n            title: \"Please Login!!\",\n            message: \"Login to like this!\",\n            type: \"danger\",\n            insert: \"top\",\n            container: \"top-center\",\n            animationIn: [\"animate__animated\", \"animate__fadeIn\"],\n            animationOut: [\"animate__animated\", \"animate__fadeOut\"],\n            dismiss: {\n              duration: 2500,\n              onScreen: true\n            },\n            \n          });}\n        else{\n        const check = wishlist.every(item =>{\n            return item._id !== product._id\n        })\n\n        if(check){\n            setWishlist([...wishlist, {...product, quantity: 1}])\n\n            await axios.patch('/user/addwishlist', {wishlist: [...wishlist, {...product, quantity: 1}]}, {\n                headers: {Authorization: token}\n            })\n\n\n            store.addNotification({\n                title: \"You like it!\",\n                message: \"This product is in your wishlist!\",\n                type: \"success\",\n                insert: \"top\",\n                container: \"top-right\",\n                animationIn: [\"animate__animated\", \"animate__fadeIn\"],\n                animationOut: [\"animate__animated\", \"animate__fadeOut\"],\n                dismiss: {\n                  duration: 2500,\n                  onScreen: true\n                }\n              });\n           \n\n        }else{\n            store.addNotification({\n                title: \"This product just in your wishlist!\",\n                message: \"Please check its!\",\n                type: \"warning\",\n                insert: \"top\",\n                container: \"top-right\",\n                animationIn: [\"animate__animated\", \"animate__fadeIn\"],\n                animationOut: [\"animate__animated\", \"animate__fadeOut\"],\n                dismiss: {\n                  duration: 2500,\n                  onScreen: true\n                },\n                \n              });\n        }}\n    }\n\n\n\n    return {\n        isLogged: [isLogged, setIsLogged],\n        isAdmin: [isAdmin, setIsAdmin],\n        cart: [cart, setCart],\n        wishlist: [wishlist,setWishlist],\n        addCart: addCart,\n        addWishList: addWishList,\n        history: [history, setHistory]\n    }\n}\n\nexport default UserAPI\n "]},"metadata":{},"sourceType":"module"}